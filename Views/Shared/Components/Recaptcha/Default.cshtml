@model GoldSim.Web.Models.Recaptcha.RecaptchaViewModel

<!-- reCaptcha -->
<input id="reCaptchaToken" name="@Model.FieldName" type="hidden" />

<script src="https://www.google.com/recaptcha/api.js?render=@Model.SiteKey" defer></script>

<script>
  window.addEventListener('DOMContentLoaded', function() {
    (function($) {
      var tokenField = $("#reCaptchaToken");
      var $form = $(tokenField.get(0).form);
      $form.submit(function(event) {
        event.preventDefault();
        var form = this;
        $form.validate();
        if ($form.valid()) {
          grecaptcha.ready(function() {
            grecaptcha.execute('@Model.SiteKey', { action: '@Model.Action' }).then(function(token) {
              tokenField.val(token);
              form.submit();
            });
          });
        }
      });
    })(jQuery);
  });
</script>

<!-- View Location: ~/Views/Shared/Components/Recaptcha/Default.cshtml -->