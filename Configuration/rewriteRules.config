<?xml version="1.0"?>
<rules>
  <rule name="HTTP to HTTPS redirect" stopProcessing="true">
    <match url="(.*)" />
    <conditions>
      <add input="{HTTPS}" pattern="off" ignoreCase="true" />
      <add input="{HTTP_HOST}" pattern="^(www.)?goldsim\.com$" ignoreCase="true" />
      <add input="{HTTP_HOST}" pattern="^admin\.goldsim\.com" negate="true" ignoreCase="true" />
    </conditions>
    <action type="Redirect" url="https://{HTTP_HOST}/{R:1}" redirectType="Permanent" />
  </rule>
  <rule name="Redirect to www" stopProcessing="true">
    <match url="(.*)" />
    <conditions>
      <add input="{HTTP_HOST}" pattern="^goldsim\.com" ignoreCase="true" />
    </conditions>
    <action type="Redirect" url="https://www.goldsim.com/{R:1}" redirectType="Permanent" />
  </rule>
  <rule name="Root Hit Redirect" stopProcessing="true">
    <match url="^$" />
    <action type="Redirect" url="/Web/Home/" redirectType="Permanent" />
  </rule>
  <rule name="Shortcut Redirects" stopProcessing="true">
    <match url="^([^/]*)/?$" ignoreCase="true" />
    <conditions>
      <add input="{Shortcuts:{R:1}}" pattern="(.+)" />
    </conditions>
    <action type="Redirect" url="{C:1}" appendQueryString="true" redirectType="Permanent" />
  </rule>
  <rule name="Retired Subsite Redirects" stopProcessing="true">
    <match url="^([^/]*)(/.*)?$" ignoreCase="true" />
    <conditions>
      <add input="{RetiredSubsites:{R:1}}" pattern="(.+)" />
    </conditions>
    <action type="Redirect" url="{C:1}" appendQueryString="true" redirectType="Permanent" />
  </rule>
  <rule name="Page Move Redirects" stopProcessing="true">
    <match url="^(.*?)(/|)$" ignoreCase="true" />
    <conditions>
      <add input="{PageMoves:{R:1}}" pattern="(.+)" />
    </conditions>
    <action type="Redirect" url="{C:1}" appendQueryString="false" redirectType="Permanent" />
  </rule>
  <rule name="Help Site Redirects" stopProcessing="true">
    <match url="^Help/?(.*?)$" ignoreCase="true" />
    <action type="Redirect" url="http://help.goldsim.com/{R:1}" appendQueryString="false" redirectType="Permanent" />
  </rule>
  <rule name="Legacy Root Redirect" stopProcessing="true">
    <match url="^Home/$" />
    <action type="Redirect" url="/Web/Home/" redirectType="Permanent" />
  </rule>
  <rule name="Application Areas Redirects" stopProcessing="true">
    <match url="^Web/Applications/(BusinessSystems|EngineeredSystems|EnvironmentalSystems)/(.*?)$" ignoreCase="true" />
    <action type="Redirect" url="/Web/Applications/Areas/{R:1}/{R:2}" appendQueryString="false" redirectType="Permanent" />
  </rule>
  <rule name="Legacy Forms Redirect" stopProcessing="true">
    <match url="^Forms/(.*?).aspx$" ignoreCase="true" />
    <action type="Redirect" url="/Forms/{R:1}/" appendQueryString="true" redirectType="Permanent" />
  </rule>
  <rule name="Legacy Showcase Section Redirect" stopProcessing="true">
    <match url="^Web/Solutions/Showcase/(.*?)$" ignoreCase="true" />
    <action type="Redirect" url="/Web/Applications/ExampleApplications/{R:1}" appendQueryString="true" redirectType="Permanent" />
  </rule>
  <rule name="Legacy Solutions Section Redirect" stopProcessing="true">
    <match url="^Web/Solutions/(.*?)$" ignoreCase="true" />
    <action type="Redirect" url="/Web/Applications/{R:1}" appendQueryString="true" redirectType="Permanent" />
  </rule>
  <rule name="Legacy Quick Tour Pages Redirect" stopProcessing="true">
    <match url="^Web/Products/GoldSim/QuickTour/Page([0-9]+)(.*?)$" ignoreCase="true" />
    <action type="Redirect" url="/Web/Products/GoldSim/QuickTour/#Slide{R:1}" redirectType="Permanent" />
  </rule>
  <rule name="Legacy Quick Tour for GoldSimPro Pages Redirect" stopProcessing="true">
    <match url="^Web/Products/GoldSimPro/QuickTour/Page([0-9]+)(.*?)$" ignoreCase="true" />
    <action type="Redirect" url="/Web/Products/GoldSim/QuickTour/#Slide{R:1}" redirectType="Permanent" />
  </rule>
  <rule name="GoldSim News Trailing Slash Redirect" stopProcessing="true">
    <match url="^Web/Company/News/([0-9\.]+)$" ignoreCase="true" />
    <action type="Redirect" url="/Web/Company/News/{R:1}/" redirectType="Permanent" appendQueryString="false" />
  </rule>
  <rule name="Legacy ModelLibrary Redirect" stopProcessing="true">
    <match url="^(.*?)/ModelLibrary/(.*?)$" ignoreCase="true" />
    <action type="Redirect" url="{R:1}/Models/{R:2}" appendQueryString="true" redirectType="Permanent" />
  </rule>
  <rule name="Legacy Redirector.aspx (Topic) Redirect" stopProcessing="true">
    <match url="^Redirector\.aspx" ignoreCase="true" />
    <conditions>
      <add input="{QUERY_STRING}" pattern="TopicID=([0-9]+)" />
    </conditions>
    <action type="Redirect" url="/Topic/{C:1}" appendQueryString="false" redirectType="Permanent" />
  </rule>
  <rule name="Legacy Redirector.aspx (Page) Redirect" stopProcessing="true">
    <match url="^Redirector\.aspx" ignoreCase="true" />
    <conditions>
      <add input="{QUERY_STRING}" pattern="PageID=([0-9]+)" />
    </conditions>
    <action type="Redirect" url="/Page/{C:1}" appendQueryString="false" redirectType="Permanent" />
  </rule>
  <rule name="Legacy Content.asp Redirect" stopProcessing="true">
    <match url="^Content\.asp" ignoreCase="true" />
    <conditions>
      <add input="{QUERY_STRING}" pattern="PageID=([0-9]+)" />
    </conditions>
    <action type="Redirect" url="/Page/{C:1}" appendQueryString="false" redirectType="Permanent" />
  </rule>
</rules>