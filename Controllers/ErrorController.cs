/*==============================================================================================================================
| Author        Ignia, LLC
| Client        GoldSim
| Project       Website
\=============================================================================================================================*/
using System.Web.Mvc;
using Ignia.Topics;
using Ignia.Topics.Repositories;
using Ignia.Topics.Web;
using Ignia.Topics.Web.Mvc;

namespace GoldSim.Web.Controllers {

  /*============================================================================================================================
  | CLASS: ERROR CONTROLLER
  \---------------------------------------------------------------------------------------------------------------------------*/
  /// <summary>
  ///   Provides access to the views associated with 400 and 500 error results.
  /// </summary>
  public class ErrorController : Controller {

    /*==========================================================================================================================
    | PRIVATE VARIABLES
    \-------------------------------------------------------------------------------------------------------------------------*/
    private ITopicRepository _topicRepository = null;
    private Topic _currentTopic = null;

    /*==========================================================================================================================
    | CONSTRUCTOR
    \-------------------------------------------------------------------------------------------------------------------------*/
    /// <summary>
    ///   Initializes a new instance of a Topic Controller with necessary dependencies.
    /// </summary>
    /// <returns>A topic controller for loading OnTopic views.</returns>
    public ErrorController(ITopicRepository topicRepository) {
      _topicRepository = topicRepository;
    }

    /*==========================================================================================================================
    | GET: /Error
    \-------------------------------------------------------------------------------------------------------------------------*/
    /// <summary>
    ///   Provides the default custom error page for the site.
    /// </summary>
    /// <returns>The site's default error view.</returns>
    public ActionResult Index() {

      /*------------------------------------------------------------------------------------------------------------------------
      | Establish faux error Topic
      \-----------------------------------------------------------------------------------------------------------------------*/
      var topic = Topic.Create("Error", "Page");
      topic.Title = "General Error";
      topic.Description = "Friendly error page.";

      /*------------------------------------------------------------------------------------------------------------------------
      | Instantiate model
      \-----------------------------------------------------------------------------------------------------------------------*/
      var topicViewModel = new TopicViewModel(_topicRepository, topic);

      /*------------------------------------------------------------------------------------------------------------------------
      | Return the view
      \-----------------------------------------------------------------------------------------------------------------------*/
      return View("Error", topicViewModel);

    }

    /*==========================================================================================================================
    | GET: /Error/NotFound
    \-------------------------------------------------------------------------------------------------------------------------*/
    /// <summary>
    ///   Provides the custom 404 error page for the site.
    /// </summary>
    /// <returns>The site's 404 (not found) error view.</returns>
    public ActionResult NotFound() {

      /*------------------------------------------------------------------------------------------------------------------------
      | Return the proper status code
      \-----------------------------------------------------------------------------------------------------------------------*/
      Response.StatusCode = 404;

      /*------------------------------------------------------------------------------------------------------------------------
      | Establish faux error Topic
      \-----------------------------------------------------------------------------------------------------------------------*/
      var topic = Topic.Create("NotFound", "Page");
      topic.Title = "Page Not Found";
      topic.Description = "Friendly 404 error page.";

      /*------------------------------------------------------------------------------------------------------------------------
      | Instantiate model
      \-----------------------------------------------------------------------------------------------------------------------*/
      var topicViewModel = new TopicViewModel(_topicRepository, topic);

      /*------------------------------------------------------------------------------------------------------------------------
      | Return the view
      \-----------------------------------------------------------------------------------------------------------------------*/
      return View("NotFound", topicViewModel);

    }

    /*==========================================================================================================================
    | GET: /Error/InternalServer
    \-------------------------------------------------------------------------------------------------------------------------*/
    /// <summary>
    ///   Provides the custom 500 error page for the site.
    /// </summary>
    /// <returns>The site's 500 (internal server) error view.</returns>
    public ActionResult InternalServer() {

      /*------------------------------------------------------------------------------------------------------------------------
      | Return the proper status code
      \-----------------------------------------------------------------------------------------------------------------------*/
      Response.StatusCode = 500;

      /*------------------------------------------------------------------------------------------------------------------------
      | Establish faux error Topic
      \-----------------------------------------------------------------------------------------------------------------------*/
      var topic = Topic.Create("InternalServer", "Page");
      topic.Title = "Internal Server Error";
      topic.Description = "Friendly 500 error page.";

      /*------------------------------------------------------------------------------------------------------------------------
      | Instantiate model
      \-----------------------------------------------------------------------------------------------------------------------*/
      var topicViewModel = new TopicViewModel(_topicRepository, topic);

      /*------------------------------------------------------------------------------------------------------------------------
      | Return the view
      \-----------------------------------------------------------------------------------------------------------------------*/
      return View("InternalServer", topicViewModel);

    }

  }
}